vars:
- auth_from_vault: "{{ lookup('community.hashi_vault.hashi_vault','automatisation/data/autovm/', auth_method=vault_auth_method,role_id=approle,secret_id=secret_id, url=vault_url) }}"

exemple de task :
- name: Get 'Hard Disk 3' details
  community.vmware.vmware_guest_disk_info:
    hostname: "{{ auto_from_vault.hostname }}"
    username: "{{ auto_from_vault.username }}"
    password: "{{ auto_from_vault.passeword }}"
    datacenter: "Toto"
    validate_certs: no
    name: "{{ item }}"
  register: disk_info
  with_items:
    - vm1
    - vm2

exemple de task utilisant approle :
    - name: Authentification aupr√®s de Vault via AppRole
      community.hashi_vault.vault_login:
        url: "{{ vault_addr }}"
        auth_method: approle
        role_id: "{{ vault_role_id }}"
        secret_id: "{{ vault_secret_id }}"
      register: vault_token
